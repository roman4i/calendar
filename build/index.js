(()=>{"use strict";function e(e){null!=document.getElementById("errorContent")&&document.getElementById("errorContent").remove();const t=document.createElement("div");return t.classList="errorCont",t.id="errorContent","participants"===e&&t.insertAdjacentText("afterbegin","Failed to create an event. Please choose participants"),"name"===e&&t.insertAdjacentText("afterbegin","Failed to create an event. Please enter event name"),"booked"===e&&t.insertAdjacentText("afterbegin","Failed to create an event. Time slot is booked. Please choose other"),t}const t={calendar:"calendar",createEvent:"createEvent"},n={routeNames:t,routes:{[t.calendar]:{name:t.calendar,path:"/calendar"},[t.createEvent]:{name:t.createEvent,path:"/create-event"}}},a="/intership-test-task/build",o=e=>{const t=n.routes[e];window.history.pushState({},e,window.location.origin+a+t.path);const o=new CustomEvent("pushStateChanged",{detail:{route:t}});document.dispatchEvent(o)},c=e=>{const{tagName:t="div",id:n,type:a,classList:o,innerText:l,children:s,value:i,text:d,onclick:r,onchange:m,selectOptions:p}=e,u=document.createElement(t);return n&&(u.id=n),o&&(u.classList=o),l&&(u.innerText=l),s&&s.length&&s.forEach((e=>{u.append(e)})),i&&(u.value=i),d&&(u.text=d),r&&(u.onclick=r),m&&(u.onchange=m),a&&(u.type=a),p&&p.length&&"select"===t&&p.forEach((e=>{const t=c({tagName:"option",value:e.value,text:e.text});u.add(t)})),u};let l=[];function s(e){const t=JSON.parse(localStorage.getItem("eventsStorage")),n=document.createElement("div");n.id="delDiv",n.classList="mainDelCont";const a=document.createElement("div");a.classList="modal-content",n.append(a);const o=document.createElement("div");o.insertAdjacentText("afterbegin",`Are you sure ypu wand to delete \n"${e}"?`),o.classList="delContStyle",a.append(o);const c=document.createElement("div");c.classList="buttonsCont",a.append(c);const l=document.createElement("input");l.type="button",l.value="No",l.onclick=()=>{n.remove()},c.append(l);const s=document.createElement("input");s.type="button",s.value="Yes",s.onclick=()=>{document.getElementById(`cellDiv${t[e].cell}`).remove(),n.remove(),delete t[e],localStorage.setItem("eventsStorage",JSON.stringify(t))},c.append(s),document.getElementById("root").append(n)}function i(e,t){const n=JSON.parse(localStorage.getItem("eventsStorage"));"all"===e&&null!==n&&Object.entries(n).forEach((([e,t])=>{const n=document.getElementById(`cell${t.cell}`),a=document.createElement("div");a.id=`cellDiv${t.cell}`,a.insertAdjacentText("afterbegin",e),a.classList="eventCell",n.append(a);const o=document.createElement("div");o.style.cursor="pointer",o.insertAdjacentText("afterbegin","×"),o.onclick=()=>{s(e)},a.append(o)})),"single"===e&&Object.entries(n).forEach((([e,n])=>{n.participiants.forEach((a=>{if(t===a){const t=document.getElementById(`cell${n.cell}`),a=document.createElement("div");a.id=`cellDiv${n.cell}`,a.insertAdjacentText("afterbegin",e),a.classList="eventCell",t.append(a);const o=document.createElement("div");o.insertAdjacentText("afterbegin","×"),o.onclick=()=>{s(e)},a.append(o)}}))}))}function d(){const e=document.createElement("div");e.id="tableCont",e.classList="tableContainer";const t=document.createElement("table"),n=document.createElement("tr");["Name","Mon","Tue","Wed","Thu","Fri"].forEach(((e,t)=>{const a=document.createElement("td");a.id=`cell${t}`,a.classList="headColorise tabCell",a.innerText=e,n.append(a)})),t.append(n);let a=7;for(let e=1;e<10;e+=1){const e=document.createElement("tr");for(let t=0;t<6;t+=1){const t=document.createElement("td");t.id=`cell${a}`,t.classList="tabCell",a+=1,e.append(t)}t.append(e)}e.append(t),document.getElementById("calendarDivCont").append(e);let o=10;for(let e=7;e<56;e+=6)document.getElementById(`cell${e}`).innerText=`${o}:00`,o+=1}localStorage.setItem("nameList",JSON.stringify(["Igor","Oleg","Olga","Yaroslav","Anna"])),window.onpopstate=()=>{const e=Object.values(n.routes).find((e=>window.location.pathname.includes(e.path)));e&&o(e.name),window.location.pathname===`${a}${n.routes[n.routeNames.createEvent].path}`&&document.getElementById("calendarDivCont").remove(),window.location.pathname===`${a}${n.routes[n.routeNames.calendar].path}`&&document.getElementById("createEventDiv").remove()},document.addEventListener("pushStateChanged",(t=>{const{route:a}=t.detail;switch(a.name){case n.routeNames.calendar:!function(){const e=c({tagName:"div",id:"calendarDivCont",classList:"calendarDiv"});document.getElementById("root").append(e),function(e){function t(){document.getElementById("tableCont").remove(),d()}const a=c({tagName:"select",id:"personSelect",classList:"personSelect",selectOptions:[{value:0,text:"All members"},...JSON.parse(localStorage.getItem("nameList")).map(((e,t)=>({value:t+1,text:e})))],onchange:()=>{if(0===a.options.selectedIndex)t(),i("all");else{t();const e=a.options.selectedIndex;i("single",a.options[e].text)}}}),l=c({tagName:"div",id:"calendarContainer",classList:"headStyle",children:[c({tagName:"div",innerText:"Calendar",classList:"headText"}),c({tagName:"div",classList:"eventContainer",children:[a,c({tagName:"input",id:"createEvent",type:"button",value:"New event +",classList:"newEvent",onclick:()=>{o(n.routeNames.createEvent),e.remove()}})]})]});e.append(l)}(e),d(),i("all")}();break;case n.routeNames.createEvent:!function(){const t=c({tagName:"div",id:"createEventDiv",classList:"eventDivStyle"}),a=c({tagName:"div",classList:"eventOptionDiv"}),s=c({tagName:"div",classList:"optionText"});s.insertAdjacentText("afterbegin","Name of the event:"),a.append(s);const i=c({tagName:"input",id:"nameField",type:"text",classList:"selectionEvent"});function d(e,n,a){const o=document.createElement("div");o.classList="eventOptionDiv";const c=document.createElement("div");c.insertAdjacentText("afterbegin",e),c.classList="optionText",o.append(c);const l=document.createElement("select");l.id=n,l.classList="selectionEvent",a.forEach(((e,t)=>{const n=document.createElement("option");n.value=t,n.text=e,l.add(n)})),o.append(l),t.append(o)}a.append(i),t.append(a),function(e,n,a){const o=document.createElement("div");o.classList="eventOptionDiv";const s=c({tagName:"div",innerText:"Participants:",classList:"optionText"});o.append(s);const i=c({tagName:"select",id:"choosePerson",classList:"selectionEvent"}),d=c({tagName:"option",text:"Select names"});i.add(d),a.forEach(((e,t)=>{const n=c({tagName:"option",value:t+1,text:e});i.add(n)})),i.onchange=()=>{if(void 0!==l[0]){let e=!0;for(let t=l.length;t>=0;t-=1)i.options[i.selectedIndex].text===l[t]&&(l.splice(t,1),e=!1,d.text=l.reduce(((e,t)=>{let n=e;return n+=`,${t}`,n})));e&&(l.push(i.options[i.selectedIndex].text),d.text=l.reduce(((e,t)=>{let n=e;return n+=`,${t}`,n}))),i.selectedIndex="0"}else l.push(i.options[i.selectedIndex].text),d.text=l.reduce(((e,t)=>{let n=e;return n+=`,${t}`,n}))},o.append(i),t.append(o)}(0,0,JSON.parse(localStorage.getItem("nameList"))),d("Day:","daySelect",["Monday","Tuesday","Wednesday","Thursday","Friday"]),d("Time:","timeSelect",["10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00"]);const r=document.createElement("div");r.classList="buttonsStyle";const m=document.createElement("input");m.type="button",m.id="cancelEventCreate",m.value="Cancel",m.classList="eventButton cancelButton",m.onclick=()=>{o(n.routeNames.calendar),t.remove(),null!=document.getElementById("errorContent")&&document.getElementById("errorContent").remove()},r.append(m);const p=document.createElement("input");p.type="button",p.value="Create",p.classList="eventButton",p.onclick=()=>{(function(){const t={participiants:[]};let n=!1;const a=document.getElementById("nameField").value;if(""!==a){t.name=a;const o=document.getElementById("choosePerson").item(0).text.split(",");o.length>0?t.participiants=[...o]:(n||document.getElementById("root").prepend(e("participants")),n=!0)}else document.getElementById("root").prepend(e("name")),n=!0;if(n)return!1;{let n,a;t.day=document.getElementById("daySelect").selectedOptions[0].label,t.time=document.getElementById("timeSelect").selectedOptions[0].label,["10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00"].forEach(((e,n)=>{t.time===e&&(a=n+1)})),["Monday","Tuesday","Wednesday","Thursday","Friday"].forEach(((e,a)=>{t.day===e&&(n=a+1)}));const o=6*a+n+1;let c=!1,l=JSON.parse(localStorage.getItem("eventsStorage"));if(null==l)return l={},l[t.name]={},l[t.name].participiants=t.participiants,l[t.name].day=t.day,l[t.name].time=t.time,l[t.name].cell=o,localStorage.setItem("eventsStorage",JSON.stringify(l)),null!=document.getElementById("errorContent")&&document.getElementById("errorContent").remove(),!0;if(Object.values(l).forEach((t=>{t.cell===o&&(document.getElementById("root").prepend(e("booked")),c=!0)})),!c)return l[t.name]={},l[t.name].participiants=t.participiants,l[t.name].day=t.day,l[t.name].time=t.time,l[t.name].cell=o,localStorage.setItem("eventsStorage",JSON.stringify(l)),null!=document.getElementById("errorContent")&&document.getElementById("errorContent").remove(),!0}})()&&(o(n.routeNames.calendar),t.remove())},l=[],r.append(p),t.append(r),document.getElementById("root").append(t)}()}})),o(n.routeNames.calendar)})();